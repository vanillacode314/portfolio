---
import 'normalize.css'
import '../styles/reset.css'
import '../styles/base.css'
import '../styles/blog.css'
import 'uno.css'
import { Background } from '@components/Background'
import Navbar from '@sections/Navbar.svelte'
import Comment from '@sections/Comment.svelte'
import Footer from '@sections/Footer.astro'
import Section from '@components/Section.astro'
import { GoogleFontsOptimizer } from 'astro-google-fonts-optimizer'
import type { Author } from '@data/authors'
import authors from '@data/authors'

export interface Props {
  frontmatter: {
    title: string
    description: string
    author: Author['id']
    url: string
    seo: {
      title: string
      description: string
      keywords: string[]
    }
  }
}

const { frontmatter } = Astro.props as Props
const slug = frontmatter.url.replace('/blog/', '')
const author = authors.find((author) => author.id === frontmatter.author)
if (!author) throw new Error(`author with id ${frontmatter.author} not found.`)
const canonicalURL = new URL(Astro.url.pathname, Astro.site)
const { default: imageSvg } = await import(`../assets/images/blog/${slug}.svg`)
const { default: imagePng } = await import(`../assets/images/blog/${slug}.png`)
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content={frontmatter.seo.description} />
    <meta name="keywords" content={frontmatter.seo.keywords.join(',')} />
    <meta name="generator" content={Astro.generator} />
    <meta property="og:description" content={frontmatter.seo.description} />
    <meta property="og:title" content={frontmatter.seo.title} />
    <meta property="og:url" content={canonicalURL} />
    <meta property="og:image" content={Astro.site + imageSvg.slice(1)} />
    <meta property="og:image" content={Astro.site + imagePng.src.slice(1)} />
    <meta property="og:image:width" content="1024" />
    <meta property="og:image:height" content="1024" />
    <meta property="og:type" content="article" />
    <link rel="canonical" href={canonicalURL} />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <GoogleFontsOptimizer
      url="https://fonts.googleapis.com/css2?family=Archivo+Narrow:ital,wght@0,400;0,500;0,600;0,700;1,400;1,700&family=JetBrains+Mono:wght@400;500;600;700&display=swap"
    />
    <title>
      {frontmatter.title + ' - Raqueebuddin Aziz'}
    </title>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-197W0VNG3Y"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || []
      window.gtag = function () {
        window.dataLayer.push(arguments)
      }
      gtag('js', new Date())
      gtag('set', 'content_group', 'blog')
      gtag('config', 'G-197W0VNG3Y', {
        cookie_domain: window.location.hostname,
        cookie_flags: 'SameSite=None;Secure',
      })
    </script>
  </head>
  <body>
    <Background client:idle />
    <Navbar sticky={false} route={Astro.url.pathname} client:load />
    <div class="blog__wrapper">
      <div class="blog__container">
        <main class="content">
          <header class="blog__header">
            <img
              class="poster"
              src={imageSvg}
              alt={frontmatter.title + ' poster'}
              width="1024"
              height="1024"
            />
            <div class="text">
              <h1 id="title">{frontmatter.title}</h1>
              <p class="author">
                By {author.name}, {author.description}
              </p>
            </div>
          </header>
          <div class="markdown">
            <slot />
          </div>
          <section class="share">
            <a
              href={`https://www.facebook.com/dialog/share?app_id=3270061229907621&display=page&hashtag=${encodeURIComponent(
                '#' + frontmatter.seo.keywords[0]
              )}&href=${canonicalURL}&redirect_uri=${canonicalURL}`}
              class="facebook-share-button"
            >
              <span class="icon-wrapper">
                <svg width="1em" height="1em" viewBox="0 0 256 256"
                  ><path
                    fill="#1877F2"
                    d="M256 128C256 57.308 198.692 0 128 0C57.308 0 0 57.307 0 128c0 63.888 46.808 116.843 108 126.445V165H75.5v-37H108V99.8c0-32.08 19.11-49.8 48.347-49.8C170.352 50 185 52.5 185 52.5V84h-16.14C152.958 84 148 93.867 148 103.99V128h35.5l-5.675 37H148v89.445c61.192-9.602 108-62.556 108-126.445"
                  ></path><path
                    fill="#FFF"
                    d="m177.825 165l5.675-37H148v-24.01C148 93.866 152.959 84 168.86 84H185V52.5S170.352 50 156.347 50C127.11 50 108 67.72 108 99.8V128H75.5v37H108v89.445A128.959 128.959 0 0 0 128 256a128.9 128.9 0 0 0 20-1.555V165h29.825"
                  ></path>
                </svg>
              </span>
              Share on Facebook</a
            >
            <a
              href={`https://twitter.com/intent/tweet?text=${
                frontmatter.title
              }&url=${canonicalURL}&hashtags=${frontmatter.seo.keywords
                .map((word) => word.replace(' ', '_'))
                .join(',')}&via=RaqueebuddinA`}
              target="_blank"
              class="twitter-share-button"
            >
              <span class="icon-wrapper">
                <svg width="1em" height="1em" viewBox="0 0 256 209"
                  ><path
                    fill="#55acee"
                    d="M256 25.45a105.04 105.04 0 0 1-30.166 8.27c10.845-6.5 19.172-16.793 23.093-29.057a105.183 105.183 0 0 1-33.351 12.745C205.995 7.201 192.346.822 177.239.822c-29.006 0-52.523 23.516-52.523 52.52c0 4.117.465 8.125 1.36 11.97c-43.65-2.191-82.35-23.1-108.255-54.876c-4.52 7.757-7.11 16.78-7.11 26.404c0 18.222 9.273 34.297 23.365 43.716a52.312 52.312 0 0 1-23.79-6.57c-.003.22-.003.44-.003.661c0 25.447 18.104 46.675 42.13 51.5a52.592 52.592 0 0 1-23.718.9c6.683 20.866 26.08 36.05 49.062 36.475c-17.975 14.086-40.622 22.483-65.228 22.483c-4.24 0-8.42-.249-12.529-.734c23.243 14.902 50.85 23.597 80.51 23.597c96.607 0 149.434-80.031 149.434-149.435c0-2.278-.05-4.543-.152-6.795A106.748 106.748 0 0 0 256 25.45"
                  ></path>
                </svg>
              </span>
              Tweet</a
            >
            <a
              href={`https://www.linkedin.com/shareArticle?mini=true&url=${canonicalURL}&title=${frontmatter.title}&summary=${frontmatter.description}&source=${Astro.url.origin}`}
              class="linkedin-share-button"
              target="_blank"
            >
              <span class="icon-wrapper">
                <svg width="1em" height="1em" viewBox="0 0 256 256"
                  ><path
                    fill="#0A66C2"
                    d="M218.123 218.127h-37.931v-59.403c0-14.165-.253-32.4-19.728-32.4c-19.756 0-22.779 15.434-22.779 31.369v60.43h-37.93V95.967h36.413v16.694h.51a39.907 39.907 0 0 1 35.928-19.733c38.445 0 45.533 25.288 45.533 58.186l-.016 67.013ZM56.955 79.27c-12.157.002-22.014-9.852-22.016-22.009c-.002-12.157 9.851-22.014 22.008-22.016c12.157-.003 22.014 9.851 22.016 22.008A22.013 22.013 0 0 1 56.955 79.27m18.966 138.858H37.95V95.967h37.97v122.16ZM237.033.018H18.89C8.58-.098.125 8.161-.001 18.471v219.053c.122 10.315 8.576 18.582 18.89 18.474h218.144c10.336.128 18.823-8.139 18.966-18.474V18.454c-.147-10.33-8.635-18.588-18.966-18.453"
                  ></path>
                </svg>
              </span>
              Share on LinkedIN</a
            >
          </section>
          <Section title="Comments" fluid>
            <Comment slug={slug} client:idle />
          </Section>
        </main>
        <aside></aside>
      </div>
    </div>
    <Footer />
    <style>
      .blog__wrapper {
      }
      .blog__container {
        --h1-text: var(--font-size-6);
        @media (--md-n-below) {
          --h1-text: var(--font-size-5);
        }
        --h2-text: var(--font-size-5);
        --h3-text: var(--font-size-4);
        /* --body-text: var(--font-size-2); */
        --code-text: 0.875rem;
        max-inline-size: var(--container-size);
        padding: var(--large-gap);
        margin-inline: auto;
        display: grid;
        grid-template-columns: auto 1fr;
      }

      .blog__header {
        display: grid;
        grid-template-columns: auto 1fr;
        margin-bottom: var(--large-gap);
        gap: var(--gap);

        @media (--md-n-below) {
          grid-template-columns: 1fr;
        }

        .poster {
          @media (--lg-n-above) {
            max-inline-size: 14rem;
          }
          border-radius: var(--radius);
        }
        h1 {
          margin-block-end: var(--smaller-gap);
          font-family: var(--headline-family);
          font-size: var(--h1-text);
        }
        .author {
          color: var(--gray-7);
          font-size: var(--body-text);
        }
      }

      .content {
        margin-block: var(--large-gap);
        max-inline-size: var(--size-md);
      }

      .markdown {
        display: grid;
        gap: var(--gap);
      }
      @media (--md-n-below) {
        aside {
          display: none;
        }
      }

      .share {
        margin-block: var(--large-gap);
        display: flex;
        gap: var(--gap);
        flex-wrap: wrap;
        font-family: var(--code-family);
        font-size: var(--font-size-0);
        font-weight: bold;
        text-transform: uppercase;
        & > a {
          border: 1px solid var(--color-1);
          background-color: var(--color-1);
          color: white;
          padding: var(--small-gap) var(--gap);
          border-radius: var(--radius);
          text-decoration: none;
          display: flex;
          gap: var(--small-gap);
          align-items: center;
          &:is(:hover, :focus) {
            background: none;
            color: black;
          }
          .icon-wrapper {
            border: 1px solid var(--color-1);
            background-color: white;
            display: grid;
            place-content: center;
            padding: var(--small-gap);
            border-radius: 100%;
          }
        }
      }
    </style>
  </body>
</html>
